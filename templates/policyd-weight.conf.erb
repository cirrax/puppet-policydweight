#
#
#  MANAGED BY PUPPET
#     do not edit this file manualy
#
# run 
#    policyd-weight defaults
# to see all available options.
#
# only values that differ from the default value need
# to be adapted.

<% @general_settings.each do |key, val| -%>
	$<%= key %> = <%= val %>;
<% end -%>

## DNSBL settings ###############################################
<% if @dnsbl_score != [] -%>
   @dnsbl_score = (
        #    HOST,                    HIT SCORE,  MISS SCORE,  LOG NAME
   <% @dnsbl_score.each do |val| -%>				    
	<%= (val['host']+',').ljust(30,' ') %><%= val['hit_score'] %>, <%= val['miss_score'] %>, <%= val['logname'] %>,
   <% end -%>
);
<% end -%>
<% @dnsbl_settings.each do |key, val| -%>
	$<%= key %> = <%= val %>;
<% end -%>

## RHSBL settings ###############################################
<% if @rhsbl_score != [] -%>
   @rhsbl_score = (
        #    HOST,                    HIT SCORE,  MISS SCORE,  LOG NAME
   <% @dnsbl_score.each do |val| -%>				    
	<%= val['host'] %>,  <%= val['hit_score'] %>,  <%= val['miss_score'] %>, <%= val['logname'] %>,
   <% end -%>
);
<% end -%>
<% @rhsbl_settings.each do |key, val| -%>
	$<%= key %> = <%= val %>;
<% end -%>

## cache stuff #################################################
<% @cache_settings.each do |key, val| -%>
	$<%= key %> = <%= val %>;
<% end -%>

## DNS settings ################################################
<% @dns_settings.each do |key, val| -%>
	$<%= key %> = <%= val %>;
<% end -%>

# scores for checks, WARNING: they may manipulate eachother
# or be factors for other scores.
#                                       HIT score, MISS Score
<% @scores.each do |key, val| -%>
   @<%= key %> = (<%= val['hit_score'] %>, <%= val['miss_score'] %>);
<% end -%>

## syslog settings ################################################
<% @syslog_settings.each do |key, val| -%>
	$<%= key %> = <%= val %>;
<% end -%>

## process options ################################################
<% @process_settings.each do |key, val| -%>
	$<%= key %> = <%= val %>;
<% end -%>
